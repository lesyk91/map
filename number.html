<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Записи</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">
    <div class="container mx-auto">
        <h1 class="text-2xl font-bold mb-4">Записи</h1>
        <div class="overflow-x-auto">
            <table id="recordsTable" class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border">№ терит</th>
                        <th class="py-2 px-4 border">Вісник</th>
                        <th class="py-2 px-4 border">Дата отримання</th>
                        <th class="py-2 px-4 border">Дата опрацювання</th>
                        <th class="py-2 px-4 border">Статус</th>
                        <th class="py-2 px-4 border">Є картка</th>
                        <th class="py-2 px-4 border">Немає картки</th>
                    </tr>
                    <tr class="bg-gray-100">
                        <th class="py-2 px-4 border"><input type="text" class="filter w-full p-1" data-column="0"></th>
                        <th class="py-2 px-4 border"><input type="text" class="filter w-full p-1" data-column="1"></th>
                        <th class="py-2 px-4 border"><input type="text" class="filter w-full p-1" data-column="2"></th>
                        <th class="py-2 px-4 border"><input type="text" class="filter w-full p-1" data-column="3"></th>
                        <th class="py-2 px-4 border"><input type="text" class="filter w-full p-1" data-column="4"></th>
                        <th class="py-2 px-4 border"><input type="text" class="filter w-full p-1" data-column="5"></th>
                        <th class="py-2 px-4 border"><input type="text" class="filter w-full p-1" data-column="6"></th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
        <button id="saveButton" class="mt-4 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">Зберегти зміни</button>
    </div>

    <script>
        // Initial data from Excel (all 102 rows)
        const initialData = [
            { "№ терит": 1, "Вісник": "Моргун Аня", "Дата отримання": "06.06.24", "Дата опрацювання": "07.06.24", "Статус": "вільно", "Є картка": 1, "Немає картки": "" },
            { "№ терит": 2, "Вісник": "Розумнюк О", "Дата отримання": "15.02.24", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 2 },
            { "№ терит": 3, "Вісник": "група", "Дата отримання": "01.04.25", "Дата опрацювання": "01.04.25", "Статус": "вільно", "Є картка": 3, "Немає картки": "" },
            { "№ терит": 4, "Вісник": "Соболівська Наталія", "Дата отримання": "01.03.23", "Дата опрацювання": "10.04.25", "Статус": "вільно", "Є картка": 4, "Немає картки": "" },
            { "№ терит": 5, "Вісник": "Соболівська Наташа", "Дата отримання": "28.06.24", "Дата опрацювання": "10.05.25", "Статус": "вільно", "Є картка": 5, "Немає картки": "" },
            { "№ терит": 6, "Вісник": "Шкіренко Діма", "Дата отримання": "06.02.24", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 6 },
            { "№ терит": 7, "Вісник": "Група", "Дата отримання": "01.04.25", "Дата опрацювання": "01.04.25", "Статус": "вільно", "Є картка": "", "Немає картки": 7 },
            { "№ терит": 8, "Вісник": "Моргун Аня", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 8 },
            { "№ терит": 9, "Вісник": "Попова Світлана", "Дата отримання": "28.02.25", "Дата опрацювання": "19.04.25", "Статус": "вільно", "Є картка": 9, "Немає картки": "" },
            { "№ терит": 10, "Вісник": "Зубачеський Олександр", "Дата отримання": "10.08.24", "Дата опрацювання": "01.09.24", "Статус": "вільно", "Є картка": 10, "Немає картки": "" },
            { "№ терит": 11, "Вісник": "Білоконь Ала", "Дата отримання": "03.08.24", "Дата опрацювання": "21.11.24", "Статус": "вільно", "Є картка": 11, "Немає картки": "" },
            { "№ терит": 12, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 12 },
            { "№ терит": 13, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 13 },
            { "№ терит": 14, "Вісник": "Пароконна Марія", "Дата отримання": "01.05.23", "Дата опрацювання": "24.07.23", "Статус": "вільно", "Є картка": 14, "Немає картки": "" },
            { "№ терит": 15, "Вісник": "Соболівська Наталія", "Дата отримання": "01.03.23", "Дата опрацювання": "22.06.23", "Статус": "вільно", "Є картка": 15, "Немає картки": "" },
            { "№ терит": 16, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 16 },
            { "№ терит": 17, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 17 },
            { "№ терит": 18, "Вісник": "Група 2", "Дата отримання": "10.09.24", "Дата опрацювання": "01.09.24", "Статус": "вільно", "Є картка": "", "Немає картки": 18 },
            { "№ терит": 19, "Вісник": "Шкіренко Дмитро", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 19 },
            { "№ терит": 20, "Вісник": "Зубачевська Валентина", "Дата отримання": "09.01.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 20, "Немає картки": "" },
            { "№ терит": 21, "Вісник": "Шкіренко Дмитро", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 21 },
            { "№ терит": 22, "Вісник": "Моргун Аня", "Дата отримання": "04.02.25", "Дата опрацювання": "01.04.25", "Статус": "вільно", "Є картка": 22, "Немає картки": "" },
            { "№ терит": 23, "Вісник": "Моргун Аня", "Дата отримання": "31.12.24", "Дата опрацювання": "01.05.25", "Статус": "вільно", "Є картка": "", "Немає картки": 23 },
            { "№ терит": 24, "Вісник": "Пароконна Марія", "Дата отримання": "19.04.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 24 },
            { "№ терит": 25, "Вісник": "Шкіренко Уляна", "Дата отримання": "13.06.25", "Дата опрацювання": "22.03.25", "Статус": "вільно", "Є картка": "", "Немає картки": 25 },
            { "№ терит": 26, "Вісник": "Зубачевський Олександр", "Дата отримання": "09.01.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 26, "Немає картки": "" },
            { "№ терит": 28, "Вісник": "Попова Світлана", "Дата отримання": "18.05.24", "Дата опрацювання": "31.10.24", "Статус": "вільно", "Є картка": "", "Немає картки": 28 },
            { "№ терит": 29, "Вісник": "Сєрова Марина", "Дата отримання": "09.03.24", "Дата опрацювання": "04.04.25", "Статус": "вільно", "Є картка": 29, "Немає картки": "" },
            { "№ терит": 30, "Вісник": "Пароконний Олег", "Дата отримання": "06.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 30 },
            { "№ терит": 31, "Вісник": "Стапай Настя", "Дата отримання": "12.05.24", "Дата опрацювання": "12.03.25", "Статус": "вільно", "Є картка": "", "Немає картки": 31 },
            { "№ терит": 32, "Вісник": "Сєрова Марина", "Дата отримання": "09.03.24", "Дата опрацювання": "01.04.25", "Статус": "вільно", "Є картка": "", "Немає картки": 32 },
            { "№ терит": 33, "Вісник": "Моргун Лесик", "Дата отримання": "23.03.25", "Дата опрацювання": "20.04.25", "Статус": "вільно", "Є картка": "", "Немає картки": 33 },
            { "№ терит": 34, "Вісник": "Пароконна Марія", "Дата отримання": "31.10.24", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 34, "Немає картки": "" },
            { "№ терит": 35, "Вісник": "Стапай Настя", "Дата отримання": "17.10.24", "Дата опрацювання": "01.04.25", "Статус": "вільно", "Є картка": 35, "Немає картки": "" },
            { "№ терит": 36, "Вісник": "Група 3", "Дата отримання": "01.03.23", "Дата опрацювання": "01.05.23", "Статус": "вільно", "Є картка": "", "Немає картки": 36 },
            { "№ терит": 37, "Вісник": "Соболівська Наталія", "Дата отримання": "15.03.25", "Дата опрацювання": "10.04.25", "Статус": "вільно", "Є картка": 37, "Немає картки": "" },
            { "№ терит": 38, "Вісник": "Група", "Дата отримання": "05.07.25", "Дата опрацювання": "05.07.25", "Статус": "вільно", "Є картка": 38, "Немає картки": "" },
            { "№ терит": 39, "Вісник": "Голеніщев Михайло", "Дата отримання": "06.02.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 39 },
            { "№ терит": 40, "Вісник": "Група", "Дата отримання": "05.07.25", "Дата опрацювання": "05.07.25", "Статус": "вільно", "Є картка": 40, "Немає картки": "" },
            { "№ терит": 41, "Вісник": "Пожогін Сергій", "Дата отримання": "04.02.25", "Дата опрацювання": "12.04.25", "Статус": "вільно", "Є картка": 41, "Немає картки": "" },
            { "№ терит": 42, "Вісник": "Моргун Анна", "Дата отримання": "25.05.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 42 },
            { "№ терит": 43, "Вісник": "Моргун Аня", "Дата отримання": "25.05.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 43 },
            { "№ терит": 44, "Вісник": "Пожогін Сергій", "Дата отримання": "03.07.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 44, "Немає картки": "" },
            { "№ терит": 45, "Вісник": "Пожогіна Марина", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 45 },
            { "№ терит": 46, "Вісник": "Група", "Дата отримання": "25.04.25", "Дата опрацювання": "25.04.25", "Статус": "вільно", "Є картка": 46, "Немає картки": "" },
            { "№ терит": 47, "Вісник": "Сороколіт Віка", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 47 },
            { "№ терит": 48, "Вісник": "Шкіренко Дмитро", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 48 },
            { "№ терит": 49, "Вісник": "Пожогін Сергій", "Дата отримання": "06.02.25", "Дата опрацювання": "12.04.25", "Статус": "вільно", "Є картка": "", "Немає картки": 49 },
            { "№ терит": 50, "Вісник": "Пароконна Марія", "Дата отримання": "06.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 50 },
            { "№ терит": 51, "Вісник": "Парокнонний Олег", "Дата отримання": "06.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 51 },
            { "№ терит": 52, "Вісник": "Затірко Валентина", "Дата отримання": "14.11.24", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 52 },
            { "№ терит": 53, "Вісник": "Соболівська Наталія", "Дата отримання": "15.03.25", "Дата опрацювання": "10.04.25", "Статус": "вільно", "Є картка": "", "Немає картки": 53 },
            { "№ терит": 54, "Вісник": "Руденко Альона", "Дата отримання": "01.08.24", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 54 },
            { "№ терит": 55, "Вісник": "Соболівська Наталія", "Дата отримання": "28.06.24", "Дата опрацювання": "10.04.25", "Статус": "вільно", "Є картка": 55, "Немає картки": "" },
            { "№ терит": 56, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 56 },
            { "№ терит": 57, "Вісник": "Попова Світлана", "Дата отримання": "12.04.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 57 },
            { "№ терит": 58, "Вісник": "Стапай Анастасія", "Дата отримання": "03.07.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 58, "Немає картки": "" },
            { "№ терит": 59, "Вісник": "Стапай Анастасія", "Дата отримання": "06.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 59 },
            { "№ терит": 60, "Вісник": "Стапай Анастасія", "Дата отримання": "06.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 60 },
            { "№ терит": 61, "Вісник": "Корнієнко Тамара", "Дата отримання": "28.06.24", "Дата опрацювання": "22.10.24", "Статус": "вільно", "Є картка": 61, "Немає картки": "" },
            { "№ терит": 62, "Вісник": "Шкіренко Дмитро", "Дата отримання": "18.05.23", "Дата опрацювання": "01.06.23", "Статус": "вільно", "Є картка": 62, "Немає картки": "" },
            { "№ терит": 63, "Вісник": "Пароконна Марія", "Дата отримання": "01.03.23", "Дата опрацювання": "24.07.23", "Статус": "вільно", "Є картка": 63, "Немає картки": "" },
            { "№ терит": 64, "Вісник": "", "Дата отримання": "", "Дата опрацювання": "", "Статус": "на руках", "Є картка": 64, "Немає картки": "" },
            { "№ терит": 65, "Вісник": "Стапай Настя", "Дата отримання": "04.05.25", "Дата опрацювання": "04.05.25", "Статус": "вільно", "Є картка": 65, "Немає картки": "" },
            { "№ терит": 66, "Вісник": "Шкіренко Ульяна", "Дата отримання": "23.03.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 66 },
            { "№ терит": 67, "Вісник": "Зубачевська Валентина", "Дата отримання": "09.01.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 67, "Немає картки": "" },
            { "№ терит": 68, "Вісник": "Пожогіна Марина", "Дата отримання": "09.01.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 68, "Немає картки": "" },
            { "№ терит": 69, "Вісник": "Пожогіна Сергій", "Дата отримання": "03.08.24", "Дата опрацювання": "23.03.25", "Статус": "вільно", "Є картка": 69, "Немає картки": "" },
            { "№ терит": 70, "Вісник": "Зубачевська Валентина", "Дата отримання": "14.11.24", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 70 },
            { "№ терит": 71, "Вісник": "Корнієнко Світлана", "Дата отримання": "31.10.24", "Дата опрацювання": "03.07.25", "Статус": "вільно", "Є картка": 71, "Немає картки": "" },
            { "№ терит": 72, "Вісник": "Зубачевська Валентина", "Дата отримання": "03.07.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 72, "Немає картки": "" },
            { "№ терит": 73, "Вісник": "Стапай Анастасія", "Дата отримання": "03.07.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 73, "Немає картки": "" },
            { "№ терит": 74, "Вісник": "Пароконна Марія", "Дата отримання": "31.10.24", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 74, "Немає картки": "" },
            { "№ терит": 75, "Вісник": "Группа", "Дата отримання": "22.03.25", "Дата опрацювання": "22.03.25", "Статус": "вільно", "Є картка": "", "Немає картки": 75 },
            { "№ терит": 76, "Вісник": "Пожогін Сергій", "Дата отримання": "25.05.25", "Дата опрацювання": "03.07.25", "Статус": "вільно", "Є картка": 76, "Немає картки": "" },
            { "№ терит": 77, "Вісник": "Пожогіна Марина", "Дата отримання": "25.05.25", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 77, "Немає картки": "" },
            { "№ терит": 78, "Вісник": "Группа", "Дата отримання": "22.03.25", "Дата опрацювання": "22.03.25", "Статус": "вільно", "Є картка": "", "Немає картки": 78 },
            { "№ терит": 79, "Вісник": "Соболівська Наталія", "Дата отримання": "27.03.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 79 },
            { "№ терит": 80, "Вісник": "Білоконь Алла", "Дата отримання": "03.08.24", "Дата опрацювання": "22.12.24", "Статус": "вільно", "Є картка": "", "Немає картки": 80 },
            { "№ терит": 81, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 81 },
            { "№ терит": 82, "Вісник": "Шкіренко Дмитро", "Дата отримання": "01.07.25", "Дата опрацювання": "03.07.25", "Статус": "вільно", "Є картка": "", "Немає картки": 82 },
            { "№ терит": 83, "Вісник": "Група 1", "Дата отримання": "05.05.24", "Дата опрацювання": "31.08.24", "Статус": "вільно", "Є картка": 83, "Немає картки": "" },
            { "№ терит": 84, "Вісник": "Шкіренко Дмитро", "Дата отримання": "28.06.25", "Дата опрацювання": "28.06.25", "Статус": "вільно", "Є картка": "", "Немає картки": 84 },
            { "№ терит": 85, "Вісник": "Шкіренко Дмитро", "Дата отримання": "28.06.25", "Дата опрацювання": "28.06.25", "Статус": "вільно", "Є картка": 85, "Немає картки": "" },
            { "№ терит": 86, "Вісник": "Шкіренко Дмитро", "Дата отримання": "28.06.25", "Дата опрацювання": "30.06.25", "Статус": "вільно", "Є картка": 86, "Немає картки": "" },
            { "№ терит": 87, "Вісник": "Зубачевська Валентина", "Дата отримання": "27.03.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 87 },
            { "№ терит": 88, "Вісник": "Моргун Аня", "Дата отримання": "27.03.24", "Дата опрацювання": "10.04.25", "Статус": "вільно", "Є картка": "", "Немає картки": 88 },
            { "№ терит": 89, "Вісник": "Зубачевська Валентина", "Дата отримання": "18.05.23", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 89 },
            { "№ терит": 90, "Вісник": "Стапай Настя", "Дата отримання": "17.10.24", "Дата опрацювання": "04.05.25", "Статус": "вільно", "Є картка": 90, "Немає картки": "" },
            { "№ терит": 91, "Вісник": "Зубачевський Олександр", "Дата отримання": "01.07.25", "Дата опрацювання": "03.07.25", "Статус": "вільно", "Є картка": "", "Немає картки": 91 },
            { "№ терит": 92, "Вісник": "Моргун Віра", "Дата отримання": "15.03.23", "Дата опрацювання": "22.06.23", "Статус": "вільно", "Є картка": 92, "Немає картки": "" },
            { "№ терит": 93, "Вісник": "Моргун Аня", "Дата отримання": "27.03.24", "Дата опрацювання": "01.05.25", "Статус": "вільно", "Є картка": "", "Немає картки": 93 },
            { "№ терит": 94, "Вісник": "Стапай Анастасія", "Дата отримання": "03.07.25", "Дата опрацювання": "03.07.25", "Статус": "вільно", "Є картка": "", "Немає картки": 94 },
            { "№ терит": 95, "Вісник": "Моргун Аня", "Дата отримання": "26.03.25", "Дата опрацювання": "31.01.25", "Статус": "вільно", "Є картка": 95, "Немає картки": "" },
            { "№ терит": 96, "Вісник": "Група", "Дата отримання": "25.04.25", "Дата опрацювання": "25.04.25", "Статус": "вільно", "Є картка": 96, "Немає картки": "" },
            { "№ терит": 97, "Вісник": "Зубачевський Олександр", "Дата отримання": "25.04.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 97 },
            { "№ терит": 98, "Вісник": "Група", "Дата отримання": "25.04.25", "Дата опрацювання": "25.04.25", "Статус": "вільно", "Є картка": 98, "Немає картки": "" },
            { "№ терит": 99, "Вісник": "Зубачевський Олександр", "Дата отримання": "03.08.24", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 99 },
            { "№ терит": 100, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 100 },
            { "№ терит": 101, "Вісник": "Соболівська Наталія", "Дата отримання": "03.07.25", "Дата опрацювання": "", "Статус": "на руках", "Є картка": "", "Немає картки": 101 },
            { "№ терит": 102, "Вісник": "Зубачевський Олександр", "Дата отримання": "03.10.24", "Дата опрацювання": "06.07.25", "Статус": "вільно", "Є картка": 102, "Немає картки": "" }
        ];

        let tableData = [];

        // Load data from localStorage or use initial data
        function loadData() {
            const savedData = localStorage.getItem('tableData');
            tableData = savedData ? JSON.parse(savedData) : initialData;
            renderTable();
        }

        // Render table
        function renderTable() {
            const tbody = document.querySelector('#recordsTable tbody');
            tbody.innerHTML = '';
            tableData.forEach((row, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="py-2 px-4 border" contenteditable="true" data-index="${index}" data-column="№ терит">${row["№ терит"]}</td>
                    <td class="py-2 px-4 border" contenteditable="true" data-index="${index}" data-column="Вісник">${row["Вісник"]}</td>
                    <td class="py-2 px-4 border" contenteditable="true" data-index="${index}" data-column="Дата отримання">${row["Дата отримання"]}</td>
                    <td class="py-2 px-4 border" contenteditable="true" data-index="${index}" data-column="Дата опрацювання">${row["Дата опрацювання"]}</td>
                    <td class="py-2 px-4 border" contenteditable="true" data-index="${index}" data-column="Статус">${row["Статус"]}</td>
                    <td class="py-2 px-4 border" contenteditable="true" data-index="${index}" data-column="Є картка">${row["Є картка"]}</td>
                    <td class="py-2 px-4 border" contenteditable="true" data-index="${index}" data-column="Немає картки">${row["Немає картки"]}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Save changes to localStorage
        document.getElementById('saveButton').addEventListener('click', () => {
            localStorage.setItem('tableData', JSON.stringify(tableData));
            alert('Дані збережено!');
        });

        // Update tableData on cell edit
        document.querySelector('#recordsTable').addEventListener('input', (e) => {
            if (e.target.hasAttribute('contenteditable')) {
                const index = e.target.dataset.index;
                const column = e.target.dataset.column;
                tableData[index][column] = e.target.textContent;
            }
        });

        // Sorting functionality
        document.querySelectorAll('#recordsTable th:not(:last-child)').forEach((header, index) => {
            header.addEventListener('click', () => {
                const column = header.textContent;
                tableData.sort((a, b) => {
                    const aValue = a[column] || '';
                    const bValue = b[column] || '';
                    return aValue.localeCompare(bValue, 'uk', { numeric: true });
                });
                renderTable();
            });
        });

        // Filtering functionality
        document.querySelectorAll('.filter').forEach(input => {
            input.addEventListener('input', () => {
                const column = input.dataset.column;
                const filterValue = input.value.toLowerCase();
                tableData = initialData.filter(row => {
                    const cellValue = (row[Object.keys(row)[column]] || '').toString().toLowerCase();
                    return cellValue.includes(filterValue);
                });
                renderTable();
            });
        });

        // Initialize table
        loadData();
    </script>
</body>
</html>
